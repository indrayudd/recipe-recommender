(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,a,t){},13:function(e,a,t){"use strict";t.r(a);var n=t(1),c=t(0),r=t.n(c),l=t(3),s=t.n(l);t(12);function i(e){return e&&e.length?(e=e.trim())[0].toUpperCase()+e.slice(1):e}function m(e){return e?e.split(" ").map(e=>e.length?e[0].toUpperCase()+e.slice(1).toLowerCase():e).join(" "):e}function o(){const[e,a]=Object(c.useState)(""),[t,l]=Object(c.useState)([]),[s,o]=Object(c.useState)(-1),d=Object(c.useRef)(!1),p=function(e,a){const[t,n]=Object(c.useState)(e);return Object(c.useEffect)(()=>{const t=setTimeout(()=>{n(e)},a);return()=>{clearTimeout(t)}},[e,a]),t}(e.trim(),300),u=Object(c.useRef)({}),[v,E]=Object(c.useState)(null),[g,h]=Object(c.useState)(null),[f,N]=Object(c.useState)(""),[b,y]=Object(c.useState)(!1),[k,w]=Object(c.useState)(!1),[j,O]=Object(c.useState)("recipe"),[C,S]=Object(c.useState)(!1),[R,x]=Object(c.useState)(!1),[_,I]=Object(c.useState)({}),[F,A]=Object(c.useState)([]),D={active:"/assets/icons/history-active.svg",inactive:"/assets/icons/history-inactive.svg"},P={active:"/assets/icons/recipe-active.svg",inactive:"/assets/icons/recipe-inactive.svg"},T={active:"/assets/icons/info-active.svg",inactive:"/assets/icons/info-inactive.svg"},B=Object(c.useCallback)(async a=>{try{const n=await fetch("https://recipe-recommender-backend.onrender.com/autocomplete?title=".concat(a)),c=await n.json();a===e.trim()&&(u.current[a]=c||[],l(c||[]),o(-1))}catch(t){console.error(t)}},[e]);Object(c.useEffect)(()=>{if(!d.current)return!p||p.length<3?(l([]),void o(-1)):void(u.current[p]?(l(u.current[p]),o(-1)):B(p));d.current=!1},[p,B]);const M=e=>{d.current=!0,a(""),l([]),o(-1),N(""),O("recipe");const t=F.find(a=>a.recipeName===e);t?(E(t.metadata),h(t.coverRecs),A(a=>{const c=a.filter(a=>a.recipeName!==e);return[Object(n.a)({},t),...c].slice(0,10)})):(y(!0),w(!0),E(null),h(null),Promise.all([fetch("https://recipe-recommender-backend.onrender.com/metadata?title=".concat(encodeURIComponent(e))).then(e=>e.json()),fetch("https://recipe-recommender-backend.onrender.com/cover_recs?title=".concat(encodeURIComponent(e))).then(e=>e.json())]).then(a=>{let[t,n]=a;t.error?N(t.error):(E(t),h(n),A(a=>{const c=a.filter(a=>a.recipeName!==e);return[{recipeName:e,metadata:t,coverRecs:n,type:"search"},...c].slice(0,10)}))}).catch(e=>{console.error(e),N("Failed to fetch recipe data")}).finally(()=>{y(!1),w(!1)}))};Object(c.useEffect)(()=>{"remix"!==j&&(S(!1),x(!1))},[j]);const U=e=>{O(e)},J=e=>{const a={};e.forEach(e=>{a[e]=!0}),I(a)},L=()=>{var e;return v?r.a.createElement("div",{style:{padding:16}},r.a.createElement("h2",{style:{marginBottom:8}},"AI Remix Page"),r.a.createElement("div",{className:"info-cover-card",style:{marginBottom:16}},r.a.createElement("h2",{className:"info-title"},v.recipe_name),r.a.createElement("img",{className:"info-cover",src:(null===g||void 0===g?void 0:g.cover_image)||"/fallback.png",alt:"Recipe Cover"})),r.a.createElement("p",null,"Deselect Missing Ingredients:"),r.a.createElement("div",{className:"chip-container"},null===(e=v.ingredients)||void 0===e?void 0:e.map(e=>{const a=e.toLowerCase(),t=a.includes("salt")||a.includes("sugar")||a.includes("oil")||a.includes("water"),c=_[e];return r.a.createElement("span",{key:e,className:"chip ".concat(c?"selected":"unselected"," ").concat(t?"undeselectable":""),onClick:()=>{t||(e=>{const a=e.toLowerCase();a.includes("salt")||a.includes("sugar")||a.includes("oil")||a.includes("water")||I(a=>Object(n.a)(Object(n.a)({},a),{},{[e]:!a[e]}))})(e)}},m(e))})),r.a.createElement("p",null,"Tap the ",r.a.createElement("strong",null,"AI Remix Button")," again below to finalize your remix.")):r.a.createElement("div",{style:{padding:20}},r.a.createElement("h2",null,"No recipe loaded to remix!"))},H=C?"#4A9390":"#EBF7F7";let z=C?"/assets/icons/sparkles-white.svg":"/assets/icons/sparkles-teal.svg";return R&&(z=null),r.a.createElement("div",{className:"mobile-container"},r.a.createElement("header",{className:"mobile-top-header"},r.a.createElement("h2",{className:"mobile-title"},"AI Recipes"),r.a.createElement("div",{className:"mobile-search-bar"},r.a.createElement("input",{type:"text",className:"search-input",placeholder:"Search recipes...",value:e,onChange:e=>{a(e.target.value),o(-1)},onKeyDown:e=>{if(t&&0!==t.length)switch(e.key){case"ArrowDown":e.preventDefault(),o(e=>Math.min(e+1,t.length-1));break;case"ArrowUp":e.preventDefault(),o(e=>Math.max(e-1,0));break;case"Enter":e.preventDefault(),s>=0&&M(t[s])}}}),r.a.createElement("button",{className:"search-button"},r.a.createElement("img",{src:"magnifying-glass.png",alt:"Search"})),t.length>0&&r.a.createElement("ul",{className:"autocomplete-dropdown"},t.map((e,a)=>r.a.createElement("li",{key:a,className:a===s?"highlighted":"",onMouseEnter:()=>o(a),onClick:()=>M(e)},e))))),r.a.createElement("div",{className:"mobile-content"},f&&r.a.createElement("p",{style:{color:"red",padding:10}},f),(()=>{var e,a;switch(j){case"history":return r.a.createElement("div",{style:{padding:20}},r.a.createElement("h2",null,"History"),0===F.length&&r.a.createElement("p",null,"No history yet."),F.map((e,a)=>{let t=e.recipeName.trim();if(t.startsWith("\u2728 ")){const e=t.slice(2).trim();t="\u2728 "+i(e)}else t=i(t);return r.a.createElement("div",{key:a,className:"history-item",onClick:()=>{O("recipe");const a=F.filter(a=>a.recipeName!==e.recipeName);A([Object(n.a)({},e),...a].slice(0,10)),E(e.metadata),h(e.coverRecs)}},r.a.createElement("strong",null,t))}));case"recipe":return b?r.a.createElement("div",{className:"recipe-page"},r.a.createElement("div",{className:"recipe-cover-card skeleton-card"}),r.a.createElement("div",{className:"skeleton-steps"}),r.a.createElement("h3",{className:"recommendation-heading"},"Recommendations"),r.a.createElement("div",{className:"recommendation-grid"},Array(4).fill(0).map((e,a)=>r.a.createElement("div",{key:a,className:"recommendation-card skeleton-recommendation"})))):r.a.createElement("div",{className:"recipe-page"},v?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"recipe-cover-card"},r.a.createElement("h2",{className:"recipe-title"},v.recipe_name),r.a.createElement("img",{className:"recipe-cover",src:(null===g||void 0===g?void 0:g.cover_image)?g.cover_image:"/fallback.png",alt:"Recipe Cover"})),(null===(e=v.steps)||void 0===e?void 0:e.length)?r.a.createElement("ol",{className:"recipe-steps"},v.steps.map((e,a)=>{const t=i(e);return r.a.createElement("li",{key:a},t)})):r.a.createElement("p",null,"No steps found"),g&&g.recommendations?r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",{className:"recommendation-heading"},"Recommendations"),k?r.a.createElement("div",{className:"recommendation-grid"},Array(4).fill(0).map((e,a)=>r.a.createElement("div",{key:a,className:"recommendation-card skeleton-recommendation"}))):r.a.createElement("div",{className:"recommendation-grid"},g.recommendations.slice(0,4).map((e,a)=>r.a.createElement("div",{key:a,className:"recommendation-card",onClick:()=>M(e.recipe_name)},r.a.createElement("p",{className:"recommendation-name"},e.recipe_name))))):null):r.a.createElement("p",{style:{padding:16}},"No recipe selected yet"));case"info":return b?r.a.createElement("div",{className:"info-page"},r.a.createElement("div",{className:"info-cover-card skeleton-card"}),r.a.createElement("div",{className:"info-stats-row"},r.a.createElement("div",{className:"macros-card skeleton-card"}),r.a.createElement("div",{className:"prep-time-card skeleton-card"})),r.a.createElement("div",{className:"ingredients-card skeleton-card"})):r.a.createElement("div",{className:"info-page"},v?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"info-cover-card"},r.a.createElement("h2",{className:"info-title"},v.recipe_name),r.a.createElement("img",{className:"info-cover",src:(null===g||void 0===g?void 0:g.cover_image)?g.cover_image:"/fallback.png",alt:"Recipe Cover"})),r.a.createElement("div",{className:"info-stats-row"},r.a.createElement("div",{className:"macros-card"},r.a.createElement("h4",null,"Macros"),v.macros?r.a.createElement("div",{className:"macros-list"},r.a.createElement("p",null,r.a.createElement("strong",null,"Calories:")," ",v.macros.calories),r.a.createElement("p",null,r.a.createElement("strong",null,"Carbs:")," ",v.macros.carbs),r.a.createElement("p",null,r.a.createElement("strong",null,"Fat:")," ",v.macros.fat),r.a.createElement("p",null,r.a.createElement("strong",null,"Protein:")," ",v.macros.protein),r.a.createElement("p",null,r.a.createElement("strong",null,"Sat Fat:")," ",v.macros.sat_fat),r.a.createElement("p",null,r.a.createElement("strong",null,"Sugar:")," ",v.macros.sugar)):r.a.createElement("p",null,"No macro info")),r.a.createElement("div",{className:"prep-time-card"},r.a.createElement("h4",null,"Prep Time"),r.a.createElement("p",{style:{fontSize:"18px",margin:"8px 0"}},v.minutes," mins"))),r.a.createElement("div",{className:"ingredients-card"},r.a.createElement("h4",null,"Ingredients"),(null===(a=v.ingredients)||void 0===a?void 0:a.length)?r.a.createElement("ul",null,v.ingredients.map((e,a)=>{const t=m(e);return r.a.createElement("li",{key:a},t)})):r.a.createElement("p",null,"No ingredients found"))):r.a.createElement("p",{style:{padding:16}},"No recipe selected yet"));case"remix":return L();default:return r.a.createElement("div",{style:{padding:20}},r.a.createElement("h2",null,"Default Page"))}})()),r.a.createElement("nav",{className:"mobile-bottom-nav"},r.a.createElement("div",{className:"nav-left"},r.a.createElement("div",{className:"nav-item",onClick:()=>U("history")},r.a.createElement("img",{src:"history"===j?D.active:D.inactive,alt:"History"}),r.a.createElement("span",null,"History")),r.a.createElement("div",{className:"nav-item",onClick:()=>U("recipe")},r.a.createElement("img",{src:"recipe"===j?P.active:P.inactive,alt:"Recipe"}),r.a.createElement("span",null,"Recipe")),r.a.createElement("div",{className:"nav-item",onClick:()=>U("info")},r.a.createElement("img",{src:"info"===j?T.active:T.inactive,alt:"Info"}),r.a.createElement("span",null,"Info"))),r.a.createElement("div",{className:"ai-button-wrapper"},r.a.createElement("button",{className:"ai-remix-button",onClick:async()=>{if(C){if(!v||!v.ingredients)return;x(!0);const t=v.ingredients.filter(e=>_[e]),n={original:v,newIngredients:t};try{const t=await fetch("https://recipe-recommender-backend.onrender.com/remix",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),c=await t.text();let r;console.log("Remix raw text:",c);try{r=JSON.parse(c)}catch(e){throw N("Error parsing remix response: "+e.message),e}r.error?N(r.error):(E(r),A(e=>{const a=e.filter(e=>e.recipeName!==r.recipe_name);return[{recipeName:"\u2728 "+r.recipe_name,metadata:r,coverRecs:g,type:"remix"},...a].slice(0,10)}),O("recipe"))}catch(a){console.error(a),N("Failed to remix recipe")}finally{x(!1),S(!1)}}else v&&v.ingredients&&J(v.ingredients),S(!0),O("remix")},style:{backgroundColor:H}},R?r.a.createElement("img",{src:"/assets/icons/loading-spinner.svg",alt:"Loading"}):z?r.a.createElement("img",{src:z,alt:"Remix"}):null))))}t.d(a,"default",function(){return o}),s.a.createRoot(document.getElementById("root")).render(r.a.createElement(o,null))}},[[13,1,2]]]);
//# sourceMappingURL=main.mobile.chunk.js.map